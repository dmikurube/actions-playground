name: Build and test
on: push
jobs:
  sqlserver:
    runs-on: ubuntu-16.04
    steps:
    - uses: actions/checkout@v1
    - name: Start Docker for mssql-server
      run: docker run -e 'ACCEPT_EULA=Y' -e 'SA_PASSWORD=somepassword' -p 1433:1433 -d mcr.microsoft.com/mssql/server:2017-CU8-ubuntu
  mysql:
    runs-on: ubuntu-latest
    services:
      mysql:
        image: mysql:5.7
        options: --health-cmd "mysqladmin ping -h localhost" --health-interval 20s --health-timeout 10s --health-retries 10
        ports:
        - "3306:3306"
        env:
          MYSQL_ROOT_PASSWORD: root
          MYSQL_USER: mysql
          MYSQL_PASSWORD: password
    steps:
    - uses: actions/checkout@v1
    - name: Connect
      run: mysql -h 127.0.0.1 --port 3306 -umysql -ppassword -e "SHOW DATABASES;"
